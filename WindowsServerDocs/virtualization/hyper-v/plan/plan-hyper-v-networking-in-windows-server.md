---
title: Планирование сетей Hyper-V в Windows Server
description: Описывает, что необходимо для основных сетей в Hyper-V и содержит ссылки на инструкции
ms.prod: windows-server
ms.service: na
manager: dongill
ms.technology: compute-hyper-v
ms.tgt_pltfrm: na
ms.topic: article
author: KBDAzure
ms.author: kathydav
ms.date: 10/04/2016
ms.openlocfilehash: f09bc82d0dd47d3393dd05dcf03913db11e4c335
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71392505"
---
# <a name="plan-for-hyper-v-networking-in-windows-server"></a>Планирование сетей Hyper-V в Windows Server

>Область применения. Microsoft Hyper-V Server 2016, Windows Server 2016, Microsoft Hyper-V Server 2019, Windows Server 2019
  
Основное представление о работе в сети в Hyper-V помогает спланировать сетевые подключения для виртуальных машин. В этой статье также рассматриваются некоторые рекомендации по работе с сетью при использовании динамической миграции и использовании Hyper-V с другими функциями и ролями сервера.  
  
## <a name="hyper-v-networking-basics"></a>Основы работы с сетями Hyper-V  
Основная сеть в Hyper-V довольно проста. В ней используются две части — виртуальный коммутатор и виртуальный сетевой адаптер. Для установки сети для виртуальной машины потребуется по крайней мере один из них. Виртуальный коммутатор подключается к любой сети на основе Ethernet. Виртуальный сетевой адаптер подключается к порту виртуального коммутатора, что позволяет виртуальной машине использовать сеть.  
  
Самый простой способ установить базовую сеть — создать виртуальный коммутатор при установке Hyper-V. Затем при создании виртуальной машины ее можно подключить к коммутатору. При подключении к коммутатору на виртуальной машине автоматически добавляется виртуальный сетевой адаптер. Инструкции см. [в статье Создание виртуального коммутатора для виртуальных машин Hyper-V](../get-started/Create-a-virtual-switch-for-Hyper-V-virtual-machines.md).  
  
Для обработки различных типов сетей можно добавить виртуальные коммутаторы и виртуальные сетевые адаптеры. Все коммутаторы являются частью узла Hyper-V, но каждый виртуальный сетевой адаптер принадлежит только одной виртуальной машине.  
  
Виртуальный коммутатор — это программный коммутатор уровня 2 сети Ethernet на основе программы. Он предоставляет встроенные функции для мониторинга, управления и сегментирования трафика, а также для обеспечения безопасности и диагностики.  Можно добавить в набор встроенных функций, установив подключаемые модули, также называемые *расширениями*. Они доступны из независимых поставщиков программного обеспечения. Дополнительные сведения о коммутаторе и расширениях см. в статье [виртуальный коммутатор Hyper-V](../../hyper-v-virtual-switch/Hyper-V-Virtual-Switch.md).  
  
### <a name="switch-and-network-adapter-choices"></a>Параметры коммутатора и сетевого адаптера  
Hyper-V предлагает три типа виртуальных коммутаторов и два типа виртуальных сетевых адаптера. Вы решите выбрать, какой из них вам нужен при создании. Для создания виртуальных коммутаторов и виртуальных сетевых адаптеров и управления ими можно использовать диспетчер Hyper-V или модуль Hyper-V для Windows PowerShell. Некоторые расширенные сетевые возможности, такие как расширенные списки управления доступом к портам (ACL), можно управлять только с помощью командлетов в модуле Hyper-V.  
  
После создания виртуального коммутатора или виртуального сетевого адаптера можно внести некоторые изменения. Например, можно изменить существующий коммутатор на другой тип, но это повлияет на сетевые возможности всех виртуальных машин, подключенных к этому коммутатору.  Таким образом, вы, вероятно, не будете делать этого, пока не поймете ошибку или не нужно проверять что-либо. В качестве другого примера можно подключить виртуальный сетевой адаптер к другому коммутатору, который вы можете сделать, если хотите подключиться к другой сети. Однако виртуальный сетевой адаптер нельзя изменить с одного типа на другой. Вместо изменения типа необходимо добавить другой виртуальный сетевой адаптер и выбрать соответствующий тип.  
  
Типы виртуальных коммутаторов:  
  
-   **Внешний виртуальный коммутатор** — подключается к проводных, физическим сетям путем привязки к физическому сетевому адаптеру.  
  
-   **Внутренний виртуальный коммутатор** — подключается к сети, которая может использоваться только виртуальными машинами, работающими на узле с виртуальным коммутатором, а также между узлом и виртуальными машинами.  
  
-   **Частный виртуальный коммутатор** — подключается к сети, которая может использоваться только виртуальными машинами, работающими на узле, на котором установлен виртуальный коммутатор, но не предоставляет сети между узлом и виртуальными машинами.  
  
Типы виртуальных сетевых адаптеров:  
  
-   **Сетевой адаптер, относящийся к Hyper-V** , доступен для виртуальных машин поколения 1 и 2. Он разработан специально для Hyper-V и требует наличия драйвера, который входит в службы интеграции Hyper-V. Этот тип сетевого адаптера быстрее и является рекомендуемым вариантом, если не требуется загрузка в сеть или не выполняется неподдерживаемая гостевая операционная система. Необходимый драйвер предоставляется только для поддерживаемых гостевых операционных систем. Обратите внимание, что в диспетчере Hyper-V и командлетах Networking этот тип просто называется сетевым адаптером.  
  
-   **Устаревший сетевой адаптер** — доступен только в виртуальных машинах поколения 1. Эмулирует адаптер PCI Fast Ethernet на основе Intel 21140 и может использоваться для загрузки в сеть, чтобы можно было установить операционную систему из службы, такой как службы развертывания Windows.  
  
## <a name="hyper-v-networking-and-related-technologies"></a>Сети и связанные технологии Hyper-V  
В последние выпуски Windows Server появились улучшения, которые предоставляют больше возможностей для настройки сети для Hyper-V. Например, в Windows Server 2012 появилась поддержка Объединенных сетей. Это позволяет маршрутизировать сетевой трафик через один внешний виртуальный коммутатор. Windows Server 2016 построен на этом, разрешая удаленный доступ к памяти (RDMA) на сетевых адаптерах, привязанных к виртуальному коммутатору Hyper-V. Эту конфигурацию можно использовать либо с параметром, либо без поддержки объединения внедренных команд (SET). Дополнительные сведения см. в разделе [RDMA &#40;&#41; с удаленным доступом к памяти и &#40;Переключение&#41; набора встроенных команд](../../hyper-v-virtual-switch/RDMA-and-Switch-Embedded-Teaming.md) .  
  
Некоторые функции зависят от конкретных конфигураций сети или более эффективны при определенных конфигурациях. Эти данные следует учитывать при планировании или обновлении сетевой инфраструктуры.  
  
**Отказоустойчивая кластеризация** . рекомендуется изолировать трафик кластера и использовать Hyper-V Quality Service (QoS) на виртуальном коммутаторе. Дополнительные сведения см. в статье [рекомендации по сети для кластера Hyper-V](https://technet.microsoft.com/library/dn550728.aspx) .  
  
**Динамическая миграция** . Используйте параметры производительности, чтобы снизить нагрузку на сеть и ЦП и время, необходимое для выполнения динамической миграции. Инструкции см. в разделе [Настройка узлов для динамической миграции без отказоустойчивой кластеризации](../deploy/set-up-hosts-for-live-migration-without-failover-clustering.md).  
  
**Локальные дисковые пространства** — эта функция полагается на сетевой протокол SMB 3.0 и RDMA. Дополнительные сведения см. [в разделе Локальные дисковые пространства в Windows Server 2016](../../../storage/storage-spaces/storage-spaces-direct-overview.md).