---
ms.assetid: 5b2876ac-fe7d-4054-bfba-b692e57bc0d2
title: Приложение C — защищенные учетные записи и группы в Active Directory
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adds
ms.openlocfilehash: cfee6eedd1582c3df960cca1c32fce27c74f82cb
ms.sourcegitcommit: d5e27c1f2f168a71ae272bebf8f50e1b3ccbcca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "86963236"
---
# <a name="appendix-c-protected-accounts-and-groups-in-active-directory"></a>Приложение В. Защищенные учетные записи и группы в Active Directory

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

## <a name="appendix-c-protected-accounts-and-groups-in-active-directory"></a>Приложение В. Защищенные учетные записи и группы в Active Directory

В Active Directory набор по умолчанию учетных записей и групп с высоким уровнем привилегий считается защищенными учетными записями и группами. При использовании большинства объектов в Active Directory полномочные администраторы (пользователи, которым были делегированы разрешения на управление объектами Active Directory) могут изменять разрешения для объектов, включая изменение разрешений, чтобы разрешить им изменять членство в группах, например.  

Однако при использовании защищенных учетных записей и групп разрешения объектов устанавливаются и применяются с помощью автоматического процесса, который гарантирует, что разрешения на объекты остаются единообразными, даже если объекты перемещаются в каталог. Даже если кто-либо вручную изменяет разрешения защищенного объекта, этот процесс гарантирует, что разрешения будут возвращаться к их значениям по умолчанию.  

### <a name="protected-groups"></a>Защищенные группы

В следующей таблице содержатся защищенные группы в Active Directory в списке операционных систем контроллера домена.  

#### <a name="protected-accounts-and-groups-in-active-directory-by-operating-system"></a>Защищенные учетные записи и группы в Active Directory операционной системой

| Windows Server 2003 RTM | Windows Server 2003 SP1 + | Windows Server 2012. <br> Windows Server 2008 R2 <br> Windows Server 2008 | Windows Server 2016 |
| --- | --- | --- | --- |
|Операторы учета|Операторы учета|Операторы учета|Операторы учета|
|Администратор|Администратор|Администратор|Администратор|
|Администраторы|Администраторы|Администраторы|Администраторы|
|Операторы архива|Операторы архива|Операторы архива|Операторы архива|
|Издатели сертификатов|||
|Администраторы домена|Администраторы домена|Администраторы домена|Администраторы домена|
|.|.|.|.|
|Администраторы предприятия|Администраторы предприятия|Администраторы предприятия|Администраторы предприятия|
|KRBTGT|KRBTGT|KRBTGT|KRBTGT|
|Операторы печати|Операторы печати|Операторы печати|Операторы печати|
|||Контроллеры домена только для чтения|Контроллеры домена только для чтения|
|Репликатор|Репликатор|Репликатор|Репликатор|
|Администраторы схемы|Администраторы схемы|Администраторы схемы|Администраторы схемы|
|Операторы сервера|Операторы сервера|Операторы сервера|Операторы сервера|

#### <a name="adminsdholder"></a>AdminSDHolder

Объект AdminSDHolder предназначен для предоставления разрешений "Template" для защищенных учетных записей и групп в домене. AdminSDHolder создается автоматически как объект в системном контейнере каждого Active Directory домена. Его путь: **CN = adminSDHolder, CN = System, DC =<domain_component>, DC =<domain_component>?.**  

В отличие от большинства объектов в домене Active Directory, владельцем которых являются группы "Администраторы", объект AdminSDHolder принадлежит группе "Администраторы домена". По умолчанию EAs может вносить изменения в объект AdminSDHolder любого домена, как и Администраторы домена домена и группы администраторов. Кроме того, несмотря на то, что владелец по умолчанию AdminSDHolder является группой администраторов домена, члены группы Администраторы или Администраторы предприятия могут становиться владельцами объекта.  

#### <a name="sdprop"></a>SDProp

SDProp — это процесс, который выполняется каждые 60 минут (по умолчанию) на контроллере домена, содержащем эмулятор основного контроллера домена (ПДЦЕ). SDProp сравнивает разрешения для объекта AdminSDHolder домена с разрешениями на защищенные учетные записи и группы в домене. Если разрешения для любой из защищенных учетных записей и групп не совпадают с разрешениями для объекта AdminSDHolder, то разрешения на защищенные учетные записи и группы сбрасываются в соответствии с параметрами объекта AdminSDHolder домена.  

Кроме того, наследование разрешений отключено для защищенных групп и учетных записей. Это означает, что даже если учетные записи и группы перемещаются в разные расположения в каталоге, они не наследуют разрешения от своих новых родительских объектов. Наследование отключено для объекта AdminSDHolder, поэтому изменение разрешений на родительские объекты не влияет на разрешения объекта AdminSDHolder.  

##### <a name="changing-sdprop-interval"></a>Изменение интервала SDProp

Обычно не нужно изменять интервал, с которым работает SDProp, за исключением целей тестирования. Если необходимо изменить интервал SDProp на ПДЦЕ для домена, используйте Regedit для добавления или изменения значения Админсдпротектфрекуенци DWORD в Хклм\систем\куррентконтролсет\сервицес\нтдс\параметерс.  

Диапазон значений в секундах — от 60 до 7200 (одна минута в два часа). Чтобы отменить изменения, удалите ключ Админсдпротектфрекуенци, который приведет к возвращению SDProp к интервалу 60 минут. Обычно не следует уменьшать этот интервал в рабочих доменах, так как он может увеличить нагрузку на контроллер домена на обработку LSASS. Влияние этого увеличения зависит от количества защищенных объектов в домене.  

##### <a name="running-sdprop-manually"></a>Запуск SDProp вручную

Лучшим подходом к тестированию изменений в AdminSDHolder является запуск SDProp вручную, что приводит к немедленному запуску задачи, но не влияет на запланированное выполнение. Выполнение SDProp вручную выполняется несколько иначе на контроллерах домена под Windows Server 2008 и более ранних версиях, чем на контроллерах домена под Windows Server 2012 или Windows Server 2008 R2.  

Процедуры для запуска SDProp вручную в старых операционных системах приведены в [Служба поддержки Майкрософт статье 251343](https://support.microsoft.com/kb/251343), а ниже приведены пошаговые инструкции для более ранних и новых операционных систем. В любом случае необходимо подключиться к объекту rootDSE в Active Directory и выполнить операцию изменения с DN, равным null, для объекта rootDSE, указав имя операции в качестве изменяемого атрибута. Дополнительные сведения об изменяемых операциях с объектом rootDSE см. в разделе [RootDSE Modify Operations](/openspecs/windows_protocols/ms-adts/fc74972f-b267-4c1a-8716-0f5b48cf52b9) на веб-сайте MSDN.  

###### <a name="running-sdprop-manually-in-windows-server-2008-or-earlier"></a>Запуск SDProp вручную в Windows Server 2008 или более ранней версии

Можно принудительно запустить SDProp с помощью Ldp.exe или сценария изменения LDAP. Чтобы запустить SDProp с помощью Ldp.exe, выполните следующие действия после внесения изменений в объект AdminSDHolder в домене:  

1. Запустите **Ldp.exe**.  
2. Щелкните **Подключение** в диалоговом окне LDP и нажмите кнопку **подключить**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_9.gif)  

3. В диалоговом окне **Подключение** введите имя контроллера домена для домена, в котором находится роль эмулятора PDC (пдце), и нажмите кнопку **ОК**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_10.png)  

4. Убедитесь, что подключение установлено успешно, как указано **DN: (RootDSE)** на следующем снимке экрана, щелкните **Подключение** и нажмите кнопку **привязать**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_11.png)  

5. В диалоговом окне **Привязка** введите учетные данные учетной записи пользователя, имеющей разрешение на изменение объекта RootDSE. (Если вы вошли в систему как пользователь, вы можете выбрать пункт **Привязать как** текущий пользователь в системе.) Нажмите кнопку **ОК**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_12.png)  

6. После завершения операции привязки нажмите кнопку **Обзор**и выберите **изменить**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_13.png)  

7. В диалоговом окне **изменение** оставьте поле **DN** пустым. В поле **изменить атрибут записи** введите **фиксупинхеританце**, а в поле **значения** введите **Да**. Нажмите клавишу **Ввод** , чтобы заполнить **список записей** , как показано на следующем снимке экрана.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_14.gif)  

8. В диалоговом окне заполненное изменение нажмите кнопку выполнить и убедитесь, что изменения, внесенные в объект AdminSDHolder, появились на этом объекте.  

> [!NOTE]  
> Сведения об изменении объекта AdminSDHolder для предоставления назначенных непривилегированных учетных записей для изменения членства в защищенных группах см. [в разделе приложение I. Создание учетных записей управления для защищенных учетных записей и групп в Active Directory](../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md).  

Если вы предпочитаете выполнять SDProp вручную с помощью LDIFDE или сценария, можно создать запись изменения, как показано ниже:  

![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_15.gif)  

###### <a name="running-sdprop-manually-in-windows-server-2012-or-windows-server-2008-r2"></a>Запуск SDProp вручную в Windows Server 2012 или Windows Server 2008 R2

Можно также принудительно запустить SDProp с помощью Ldp.exe или сценария изменения LDAP. Чтобы запустить SDProp с помощью Ldp.exe, выполните следующие действия после внесения изменений в объект AdminSDHolder в домене:  

1. Запустите **Ldp.exe**.  

2. В диалоговом окне **LDP** щелкните **Подключение**и нажмите кнопку **подключить**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_16.gif)  

3. В диалоговом окне **Подключение** введите имя контроллера домена для домена, в котором находится роль эмулятора PDC (пдце), и нажмите кнопку **ОК**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_17.gif)  

4. Убедитесь, что подключение установлено успешно, как указано **DN: (RootDSE)** на следующем снимке экрана, щелкните **Подключение** и нажмите кнопку **привязать**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_18.gif)  

5. В диалоговом окне **Привязка** введите учетные данные учетной записи пользователя, имеющей разрешение на изменение объекта RootDSE. (Если вы вошли в систему как пользователь, вы можете выбрать пункт **Привязать как текущий пользователь в системе**.) Нажмите кнопку **ОК**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_19.gif)  

6. После завершения операции привязки нажмите кнопку **Обзор**и выберите **изменить**.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_20.gif)  

7. В диалоговом окне **изменение** оставьте поле **DN** пустым. В поле **изменить атрибут записи** введите **рунпротектадминграупстаск**, а в поле **значения** введите **1**. Нажмите клавишу **Ввод** , чтобы заполнить список записей, как показано ниже.  

   ![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_21.gif)  

8. В диалоговом окне заполненное **изменение** нажмите кнопку **выполнить**и убедитесь, что изменения, внесенные в объект adminSDHolder, появились на этом объекте.  

Если вы предпочитаете выполнять SDProp вручную с помощью LDIFDE или сценария, можно создать запись изменения, как показано ниже:  

![защищенные учетные записи и группы](media/Appendix-C--Protected-Accounts-and-Groups-in-Active-Directory/SAD_22.gif)  
