---
title: Запуск анализатор соответствия рекомендациям сканирование и управление Results_1 сканирования
description: Диспетчер серверов
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-server-manager
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 232f1c80-88ef-4a39-8014-14be788c2766
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 6edd561749ea0d224058b482992d357357c12505
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71383078"
---
# <a name="run-best-practices-analyzer-scans-and-manage-scan-results"></a>Запуск проверок анализатором соответствия рекомендациям и управление результатами проверок

>Область применения. Windows Server 2016

В управлении Windows *рекомендации* — это инструкции по настройке сервера, которые эксперты считают наилучшими в обычных условиях. Например, для большинства серверных технологий считается оптимальным сохранять открытыми только порты, необходимые для обмена данными с другими компьютерами сети, и блокировать неиспользуемые порты. Хотя нарушение рекомендаций, даже очень важных, необязательно представляет собой проблему, они указывают конфигурации сервера, которые могут привести к снижению производительности и надежности, непредвиденным конфликтам, повышению рисков для безопасности и другим потенциальным неполадкам.

Анализатор соответствия рекомендациям (BPA) — это средство управления сервером, доступное в Windows Server 2012 R2, Windows Server 2012 и Windows Server 2008 R2. Анализатор соответствия рекомендациям помогает администраторам уменьшить количество нерекомендуемых рекомендаций путем сканирования ролей, установленных на управляемых серверах под управлением Windows Server 2012 или Windows Server 2008 R2, и создания отчетов о нерекомендуемых рекомендациях для администратора.

Анализатор соответствия рекомендациям (анализатор соответствия рекомендациям) можно использовать для сканирования из диспетчер сервера, с помощью ГИП анализатора соответствия рекомендациям или с помощью командлетов в Windows PowerShell. начиная с Windows Server 2012, можно сканировать одну роль или несколько ролей одновременно на нескольких серверах, независимо от того, используется ли плитка анализатор соответствия рекомендациям в консоли диспетчер сервера или командлеты Windows PowerShell для выполнения проверок. Также в анализаторе соответствия рекомендациям можно задать исключение или игнорирование результатов проверки, которые не нужно отображать.

Эта статья содержит следующие разделы.

-   [найти анализатор соответствия рекомендациям](#BKMK_find)

-   [Принцип работы BPA](#BKMK_how)

-   [Выполнение анализатор соответствия рекомендациям сканирование ролей](#BKMK_BPAscan)

-   [Управление результатами проверки](#BKMK_manage)

## <a name="BKMK_find"></a>найти анализатор соответствия рекомендациям
Плитку анализатор соответствия рекомендациям можно найти на страницах "роль" и "Группа серверов" диспетчер сервера в Windows Server 2012 R2 и Windows Server 2012. также можно открыть сеанс Windows PowerShell с повышенными правами пользователя для запуска командлетов анализатор соответствия рекомендациям.

## <a name="BKMK_how"></a>Принцип работы BPA
Анализатор соответствия рекомендациям оценивает соответствие ролей требованиям с рекомендациями по восьми различным категориям эффективности, надежности и надежностью. Результатом такого измерения является один из трех уровней серьезности, которые описаны в следующей таблице.

|Уровень серьезности|Описание|
|---------|--------|
|Ошибка|Результат "Ошибка" возвращается в том случае, если роль не удовлетворяет условиям некоторого правила рекомендаций, в результате чего можно ожидать проблем с работоспособностью.|
|Сведения|Результат "Информация" возвращается в том случае, если роль удовлетворяет условиям правила.|
|Предупреждение|Результат "Предупреждение" возвращается в том случае, если несоответствие может привести к проблемам, если не будут сделаны изменения. В настоящий момент роль может соответствовать условиям правила, но может утратить это соответствие, если не внести изменения в ее конфигурацию или параметры политики. Например, проверка служб удаленных рабочих столов может выдать результат "Предупреждение", если сервер лицензирования недоступен для роли, поскольку, даже если во время проверки нет активных удаленных подключений, отсутствие сервера лицензирования не позволяет новым удаленным подключениям получить действующие лицензии на клиентский доступ.|

### <a name="rule-categories"></a>Категории правил
В следующей таблице описаны категории правил, по которым оцениваются роли во время сканирования анализатор соответствия рекомендациям.

|Название категории|Описание|
|---------|--------|
|Безопасность|Правила безопасности применяются для оценки относительных рисков роли при раскрытии таких угроз, как несанкционированные или злонамеренные пользователи, потеря или кража конфиденциальных или частных данных.|
|Производительность|Правила производительности применяются для измерения способности роли обрабатывать запросы и выполнять предписанные обязанности в Организации в течение предполагаемых периодов времени с учетом рабочей нагрузки роли.|
|Конфигурация|Правила конфигурации применяются для определения параметров роли, изменение которых может потребоваться для оптимального функционирования роли. Правила конфигурации помогают предотвратить конфликты параметров, которые могут привести к появлению сообщений об ошибках или помешать роли выполнять назначенные функции на предприятии.|
|Политика|Правила политики применяются для указания групповая политика или параметров реестра Windows, которые могут требовать изменения для обеспечения оптимальной и безопасной эксплуатации роли.|
|Операция|Правила использования применяются для выявления возможных сбоев при выполнении назначенных задач роли на предприятии.|
|Перед развертыванием|Правила перед развертыванием применяются до того, как установленная роль будет развернута на предприятии. Они позволяют администраторам оценивать, соблюдены ли рекомендации, до использования роли на производстве.|
|После развертывания|Правила после развертывания применяются после того, как все необходимые для роли службы будут запущены, и роль начнет выполняться на предприятии.|
|Предварительные требования|Правила необходимых условий поясняют, какие параметры конфигурации, параметры политик и компоненты необходимы для роли, прежде чем анализатор будет применять конкретные правила из прочих категорий. Необходимое условие в результатах проверки указывает на неверный параметр, отсутствующую программу, неправильно включенную или отключенную политику, параметр раздела реестра или другие особенности конфигурации, из-за которых анализатору соответствия рекомендациям не удается применить одно или несколько правил во время проверки. Необходимое условие в результатах не означает соответствия или несоответствия. Оно говорит лишь о том, что правило нельзя применить, и поэтому не входит в результаты проверки.|

## <a name="BKMK_BPAscan"></a>Выполнение анализатор соответствия рекомендациям сканирование ролей
Проверки BPA можно выполнять для ролей с помощью графического интерфейса анализатора соответствия рекомендациям в диспетчер сервера или с помощью командлетов Windows PowerShell.

В Windows Server 2012 R2 и Windows Server 2012 некоторые роли предложит указать дополнительные параметры, такие как имена определенных серверов или общих папок, в которых выполняются части роли, или идентификаторы подмоделей перед запуском проверки анализатора соответствия рекомендациям. В случае проверки анализатором соответствия рекомендациям моделей, требующих задавать дополнительные параметры, используйте командлеты BPA; пользовательский интерфейс анализатора соответствия рекомендациям не поддерживает дополнительные параметры, такие как идентификаторы подмоделей. Например, идентификатор подмодели **FSRM** представляет подмодель файловых служб BPA для диспетчера ресурсов файлового сервера — службу роли файловых служб и служб хранилища. Чтобы запустить проверку только в службе роли файлового сервера диспетчер ресурсов, запустите проверку BPA с помощью командлетов Windows PowerShell и добавьте параметр `SubmodelId` в командлет.

Хотя вы не можете передавать дополнительные параметры для проверки, запускаемой в ГИП анализатора соответствия рекомендациям, плитка BPA в диспетчер сервера отображает результаты для последней проверки анализатора соответствия рекомендациям, независимо от того, как была запущена проверка.

-   [Проверка ролей с помощью ГИП анализатора соответствия рекомендациям](#BKMK_GUIscan)

-   [Проверка ролей с помощью командлетов Windows PowerShell](#BKMK_PSscan)

### <a name="BKMK_GUIscan"></a>Проверка ролей с помощью ГИП анализатора соответствия рекомендациям
Для проверки одной роли в графическом интерфейсе пользователя анализатора соответствия рекомендациям выполните следующие действия.

##### <a name="to-scan-roles-by-using-the-bpa-gui"></a>Проверка роли при помощи графического интерфейса пользователя анализатора соответствия рекомендациям

1.  Выполните одно из следующих действий, чтобы открыть диспетчер сервера, если он еще не открыт.

    -   На панели задач Windows нажмите кнопку диспетчер сервера.

    -   На **начальном** экране щелкните плитку Диспетчер сервера.

2.  В области переходов откройте страницу роли или группы.

    При проверке анализатором соответствия рекомендациям, которая выполняется со страницы роли или группы, проверяются все роли, установленные на серверах этой группы.

3.  В меню **задачи** на плитке **анализатор соответствия рекомендациям** щелкните **запустить проверку BPA**.

4.  В зависимости от количества правил, соответствие которым оценивается для выбранной роли или группы, проверка может занять несколько минут.

### <a name="BKMK_PSscan"></a>Проверка ролей с помощью командлетов Windows PowerShell
Используйте следующие процедуры для сканирования одной или нескольких ролей с помощью командлетов Windows PowerShell.

> [!NOTE]
> В процедурах данного раздела показаны не все командлеты и параметры анализатора соответствия рекомендациям. Чтобы получить дополнительные сведения об операциях BPA в Windows PowerShell, в сеансе Windows PowerShell введите **Get-Help***бпакмдлет***-Full**, где *бпакмдлет* может иметь одно из следующих значений. Разделы справки по командлетам BPA можно также найти в [техническом центре Windows Server](https://go.microsoft.com/fwlink/p/?LinkId=240177).

-   **Get-Бпамодел**

-   **Invoke-Бпамодел**

-   **Get-Бпаресулт**

-   **Set-Бпаресулт**

#### <a name="BKMK_singlerole"></a>Сканирование одной роли с помощью командлетов Windows PowerShell

1.  Выполните одно из следующих действий, чтобы запустить Windows PowerShell с повышенными правами пользователя.

    -   Чтобы запустить Windows PowerShell от имени администратора на **начальном** экране, щелкните правой кнопкой мыши плитку **Windows PowerShell** в окне результаты **приложений** , а затем на панели приложения щелкните **Запуск от имени администратора**.

    -   Чтобы запустить Windows PowerShell от имени администратора на рабочем столе, щелкните правой кнопкой мыши ярлык **Windows PowerShell** на панели задач и выберите команду **Запуск от имени администратора**.

2.  начиная с Windows PowerShell 3,0, модули командлетов автоматически импортируются в сеанс Windows PowerShell при первом использовании командлета из модуля. Импортировать или загружать модуль командлетов анализатора соответствия рекомендациям не требуется.

3.  Найдите идентификаторы всех ролей, для которых можно выполнить проверку BPA, введя командлет **Get-бпамодел** , как показано в следующем примере.

    `Get-Bpamodel`

4.  В результатах выполнения шага 3 найдите идентификаторы моделей ролей, которые нужно проверить анализатором соответствия рекомендациям.

5.  Чтобы запустить проверку конкретной роли анализатором соответствия рекомендациям, введите любую из следующих команд: В случае нескольких ролей разделяйте идентификаторы моделей запятыми.

    `Invoke-BPAmodel -modelId <modelID_from_Step3>`

    `Invoke-BPAmodel <modelID_from_Step3>`

    **Пример:**  `Invoke-BPAmodel -modelId Microsoft/Windows/DNSServer,Microsoft/Windows/FileServices`

    > [!NOTE]
    > Идентификатор модели содержит весь путь, который отображается в столбце **Id** — например **Microsoft/Windows/Hyper-V**.

    Можно также запустить проверку конкретной роли из результатов шага 3, направив результаты выполнения командлета `Get-BPAmodel` по конвейеру в командлет `Invoke-BPAmodel` , как показано в следующем примере.

    `Get-BPAmodel <model_ID> | Invoke-BPAmodel`

    При выполнении этого командлета без указания идентификатора модели каналы все модели, возвращаемые командлетом `Get-BPAmodel`, в командлет `Invoke-BPAmodel` запускается проверка на всех моделях, доступных на серверах, добавленных в пул серверов диспетчер сервера.

#### <a name="BKMK_allroles"></a>Проверка всех ролей с помощью командлетов Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя, если он еще не открыт. Инструкции см. в описании предыдущей процедуры.

2.  Для запуска проверок BPA передайте в командлет `Invoke-BPAmodel` по конвейеру все роли, для которых можно выполнить проверку анализатором соответствия рекомендациям.

    `Get-BPAmodel | Invoke-BPAmodel`

3.  После завершения проверки Windows PowerShell возвращает результаты, аналогичные приведенным ниже, для каждой проверенной роли.

    ```
    modelId                 :  Microsoft/Windows/FileServices
    SubmodelId              :
    Success                 :  True
    Scantime                :  1/01/2012  12:18:40 PM
    ScantimeUtcOffset       :  -08:00:00
    detail                  :  {server_name1, server_name2}

    ```

## <a name="BKMK_manage"></a>Управление результатами проверки
После выполнения проверки в графическом интерфейсе анализатора соответствия рекомендациям можно просмотреть результаты проверки на плитке анализатора. Когда пользователь выбирает какой-либо результат на плитке, в области просмотра на этой плитке отображаются свойства результата, в том числе сведения о том, удовлетворяет ли роль соответствующей рекомендации. Если результат не соответствует требованиям и вы хотите знать, как устранить проблемы, описанные в свойствах результата, гиперссылки в свойствах результата ошибки и предупреждения откройте подробные разделы справки по решению в центре Windows Server TechCenter.

> [!NOTE]
> Результаты проверки анализатором соответствия рекомендациям не сохраняются и не архивируются автоматически. При запуске новой проверки модели или подмодели результаты предыдущей проверки теряются. О том, как сохранить результаты проверки анализатором соответствия рекомендациям для архивации, печати или пересылки другим пользователям, см. статью [Просмотр результатов BPA из сеансов Windows PowerShell в различных форматах](#BKMK_formats) в этом разделе.

### <a name="exclude-and-include-bpa-results"></a>Исключение и включение результатов BPA
Если нет необходимости просматривать некоторые результаты BPA, например результаты, которые часто встречаются в проверках анализатора соответствия рекомендациям, но не требуют разрешения, можно исключить результаты с помощью пользовательского интерфейса анализатора соответствия рекомендациям или командлетов BPA в Windows PowerShell. В любое время эти результаты можно будет включить снова.

> [!NOTE]
> Исключенные результаты также скрываются от просмотра на управляемых серверах. Другие администраторы не могут видеть исключенные результаты на управляемых серверах. Чтобы исключить результаты из представления только в локальной консоли диспетчер сервера, создайте пользовательский запрос вместо использования команды **исключить результат** .

#### <a name="BKMK_exclude"></a>Исключить результаты проверки
Параметр **Исключить** действует постоянно: исключенные результаты остаются таковыми при дальнейших проверках той же модели на том же компьютере, пока не будут снова включены.

Исключить результаты проверки можно с помощью командлета `Set-BPAResult` с параметром `Exclude` . Как и на плитке анализатор соответствия рекомендациям в диспетчер сервера можно исключить отдельные объекты результатов или исключить набор результатов, поля которых (например, категория, заголовок и серьезность) которых равны или содержат указанные значения. Например, можно исключить все результаты **Производительность** из набора результатов проверки роли.

> [!NOTE]
> Чтобы использовать процедуры, описанные в этом разделе, необходимо выполнить хотя бы одну проверку модели анализатором соответствия рекомендациям.

###### <a name="to-exclude-scan-results-by-using-the-gui"></a>Исключение результатов проверки при помощи графического интерфейса анализатора соответствия рекомендациям

1.  Откройте страницу «роль» или «группа серверов» в диспетчер сервера.

2.  На плитке анализатор соответствия рекомендациям для роли или группы серверов щелкните правой кнопкой мыши результат в списке и выберите пункт **исключить результат**.

    Этот результат не будет отображаться в списке результатов.

3.  Чтобы просмотреть исключенные результаты в графическом интерфейсе пользователя, запустите встроенный запрос **Исключенные результаты** . Щелкните **Сохраненные условия поиска**, а затем **Исключенные результаты**.

    После выполнения запроса **Исключенные результаты** обратите внимание, что текст подзаголовка плитки с описанием отображаемых в списке результатов поменялся на **Исключенные результаты**. В этом списке фигурируют только исключенные результаты.

###### <a name="to-exclude-scan-results-by-using-windows-powershell-cmdlets"></a>Исключение результатов проверки при помощи командлетов Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя.

2.  Исключите конкретные результаты из проверки модели путем запуска следующей команды.

    `Get-BPAResult -modelId <model ID> | Where { $_.<Field Name> -eq "Value"} | Set-BPAResult -Exclude $true`

    Предыдущая команда извлекает элементы результатов проверки BPA для идентификатора модели, представленного *идентификатором модели*.

    Второй сегмент команды фильтрует результаты командлета `Get-BPAResult` , отбирая из них только те результаты проверки, для которых значение поля, представленного заполнителем *Имя поля*, совпадает с текстом в кавычках.

    Последний раздел команды, следующий за вторым символом вертикальной черты, исключает результаты, отфильтрованные по предыдущему разделу командлета.

    **Пример:**  `Get-BPAResult -Microsoft/Windows/FileServices | Where { $_.Severity -eq "Information"} | Set-BPAResult -Exclude $true`

#### <a name="include-scan-results"></a>Включение результатов проверки
Если требуется, чтобы ранее исключенные результаты проверки снова отображались, можно их включить. Параметр **Включить** действует постоянно: включенные результаты остаются таковыми при дальнейших проверках той же модели на том же компьютере.

##### <a name="BKMK_gui"></a>Включение результатов проверки с помощью графического интерфейса пользователя

1.  Откройте страницу «роль» или «группа серверов» в диспетчер сервера.

2.  На плитке анализатор соответствия рекомендациям для роли или группы серверов щелкните правой кнопкой мыши исключенный результат в списке список **исключенных результатов** и выберите пункт **включить результат**.

    Этот результат более не будет отображаться в списке исключенных результатов. Очистите запрос, щелкнув **Очистить все** , чтобы увидеть включенный результат в списке всех включенных результатов.

##### <a name="BKMK_cmdlets"></a>Включение результатов проверки с помощью командлетов Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя.

2.  Включите конкретные результаты проверки модели, введя следующую команду и нажав клавишу **ВВОД**:

    `Get-BPAResult -modelId <model Id> | Where { $_.<Field Name> -eq "Value" } | Set-BPAResult -Exclude $false`

    Предыдущая команда извлекает элементы результатов проверки BPA для модели, представленной *идентификатором модели*.

    Вторая часть команды после символа первого канала ( **|** ) фильтрует результаты командлета **Get-бпаресулт** , чтобы получить только те результаты проверки, для которых значение поля результата, представленное *именем поля*, соответствует. текст в кавычках.

    После второго знака вертикальной черты последний сегмент команды включает результаты, отобранные вторым сегментом. Для этого в качестве значения параметра **-Exclude** устанавливается **false**.

    **Пример:**  `Get-BPAResult -Microsoft/Windows/FileServices | Where { $_.Severity -eq "Information"} | Set-BPAResult -Exclude $false`

### <a name="view-and-export-bpa-scan-results-in-windows-powershell"></a>Просмотр и экспорт результатов проверки анализатором соответствия рекомендациям в Windows PowerShell
Для просмотра результатов проверки и управления ими с помощью командлетов Windows PowerShell см. следующие процедуры. Чтобы использовать процедуры, приведенные в этом разделе, необходимо выполнить хотя бы одну проверку модели или подмодели анализатором соответствия рекомендациям.

#### <a name="BKMK_recentPS"></a>Просмотр результатов последней проверки роли с помощью Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя.

2.  Получите результаты последней проверки для заданного идентификатора модели. Введите следующую команду, в которой модель представлена *идентификатором модели*, и нажмите клавишу **Ввод**. Можно получить результаты для нескольких моделей, разделив идентификаторы моделей запятыми.

    `Get-BPAResult <model ID>`

    **Пример:** `Get-BPAResult Microsoft/Windows/DNSServer,Microsoft/Windows/FileServices`

    Если вы проверили подмодель модели, например службу роли, получите результаты только для этой подмодели, включив в командлет идентификатор подмодели.

    **Пример:** `Get-BPAResult Microsoft/Windows/FileServices -SubmodelID FSRM`

#### <a name="BKMK_formats"></a>Просмотр или сохранение результатов BPA из сеансов Windows PowerShell в различных форматах

-   В Windows PowerShell каждый результат BPA напоминает следующее.

    ```
    ResultNumber     :  14
    ResultId         :  1557706192
    modelId          :  Microsoft/Windows/FileServices
    SubmodelId       :  FSRM
    RuleId           :  16
    computerName     :  server_name1, server_name2
    Context          :  FileServices
    Source           :  server_name1
    Severity         :  Information
    Category         :  Configuration
    Title            :  Access Denied remediation requires remote management be enabled on this server
    Problem          :
    Impact           :
    Resolution       :
    compliance       :  The File Server Best Practices Analyzer scan has determined that you are in compliance with this best practice.
    help             :
    Excluded         :  False

    ```

    Выполните одно из указанных ниже действий.

    -   Чтобы представить результаты BPA в табличном виде, запустите следующий командлет, добавив интересующие вас свойства результата из предыдущего примера.

        `Get-BPAResult model ID | format-Table -Property <property1,property2,property3...>`

        **Пример:**  `Get-BPAResult Microsoft/Windows/FileServices | format-Table -Property modelId,SubmodelId,computerName,Source,Severity,Category,Title,Problem,Impact,Resolution,compliance,help`

    -   Чтобы отобразить результаты BPA в сетке графического интерфейса с фильтром по текстовой строке и заголовками столбцов, которые можно щелкать для сортировки, запустите следующий командлет.

        `Get-BPAResult <model ID> | OGV`

    -   Чтобы экспортировать результаты BPA в HTML-файл, который можно заархивировать или отправить получателям электронной почты, выполните следующий командлет, где *path* представляет путь и имя файла, в котором необходимо сохранить результаты в формате HTML.

        `Get-BPAResult <model ID> | convertTo-Html | Set-Content <path>`

        **Пример:**  `Get-BPAResult Microsoft/Windows/FileServices | convertTo-Html | Set-Content C:\BPAResults\FileServices.htm`

    -   Чтобы экспортировать результаты BPA в текстовый файл с разделителями-запятыми (CSV), выполните следующий командлет, где *path* представляет путь и имя текстового файла, в который необходимо сохранить результаты CSV. Результаты CSV можно импортировать в Microsoft Excel или другие программы, отображающие данные в электронных таблицах или сетках.

        `Get-BPAResult <model ID> | Export-CSV <path>`

        **Пример:**  `Get-BPAResult Microsoft/Windows/FileServices | Export-CSV C:\BPAResults\FileServices.txt`

## <a name="see-also"></a>См. также
[Анализатор соответствия рекомендациямное решение для Windows Server TechCenter](https://go.microsoft.com/fwlink/p/?LinkId=241597)
.[Фильтрация, сортировка и запрос данных в диспетчер сервера плитках](filter-sort-and-query-data-in-server-manager-tiles.md)
[Управление несколькими удаленными серверами с Диспетчер сервера](manage-multiple-remote-servers-with-server-manager.md)
